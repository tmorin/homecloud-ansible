---

- name: Copy docker-prune.service
  become: true
  template:
    src: docker-prune.service
    dest: /etc/systemd/system/docker-prune.service
    owner: root
    group: root
    mode: 0644
    force: true

- name: Copy docker-prune.timer
  become: true
  template:
    src: docker-prune.timer
    dest: /etc/systemd/system/docker-prune.timer
    owner: root
    group: root
    mode: 0644
    force: true

- name: Copy the script
  become: true
  template:
    src: docker-prune.sh
    dest: /usr/local/bin/docker-prune
    owner: root
    group: root
    mode: 0755
    force: true

- name: Activate docker-prune.service
  become: true
  systemd:
    daemon_reload: true
    name: docker-prune.service
    enabled: true

- name: Enable and start docker-prune.timer
  become: true
  systemd:
    daemon_reload: true
    name: docker-prune.timer
    enabled: true
    state: started
