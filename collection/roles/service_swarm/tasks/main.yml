---

- name: 'create the vault directory'
  delegate_to: localhost
  file:
    path: "{{ homecloud_vault_path }}"
    state: directory
    mode: 0755

- name: 'initialize the main manager'
  when: inventory_hostname in groups.swarm_mgr[:1]
  block:
    - import_tasks: initialize-swarm.yml

- name: 'initialize the secondary managers'
  when: inventory_hostname in groups.swarm_mgr[1:] | default([])
  block:
    - import_tasks: join-as-manager.yml

- name: 'initialize the workers'
  when: inventory_hostname in groups.swarm_wkr | default([])
  block:
    - import_tasks: join-as-worker.yml
