---

- name: 'join as manager'
  community.general.docker_swarm:
    remote_addrs: ["{{ service_swarm_manager_ip }}"]
    advertise_addr: "{{ hostvars[inventory_hostname].homecloud_node_ip }}"
    join_token: "{{ lookup('file', playbook_dir~'/vault/token_manager') }}"
    state: join
    labels: "{{ service_swarm_node_labels }}"
  register: join_as_manager
