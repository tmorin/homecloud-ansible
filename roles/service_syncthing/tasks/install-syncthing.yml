---

- name: "install dependencies"
  become: yes
  package:
    pkg: apt-transport-https
    state: present
    force_apt_get: "yes"
  register: install_syncthing

- name: "import Syncthing GPG key to apt"
  become: yes
  apt_key:
    url: "https://syncthing.net/release-key.txt"
    state: present
  register: install_syncthing

- name: "add Syncthing repository"
  become: yes
  apt_repository:
    repo: 'deb https://apt.syncthing.net/ syncthing stable'
    state: present
  register: install_syncthing

- name: "install Syncthing"
  become: yes
  package:
    name: syncthing
    state: present
    force_apt_get: "yes"
  register: install_syncthing
