---

- hosts: all
  tasks:

    - name: Update packages
      become: yes
      apt:
        update_cache: yes
        autoclean: yes
        autoremove: yes
        force_apt_get: yes

    - name: Format the block device of DNAS
      when: service_dnas_mount_what is defined
      become: yes
      community.general.filesystem:
        dev: "{{ service_dnas_mount_what }}"
        force: false
        fstype: ext4

    - name: Format the block device of Longhorn
      when: k3s_longhorn_mount_what is defined
      become: yes
      community.general.filesystem:
        dev: "{{ k3s_longhorn_mount_what }}"
        force: false
        fstype: ext4
